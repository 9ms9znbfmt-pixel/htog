<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Solitude- 001</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body class="page-selected-card">
  <main class="page">
    <section class="frame" aria-label="Selected">
      <div class="frame-inner">

        <header class="top">
          <div class="top-brand">
            <a href="index.html">HtoG</a>
          </div>

          <nav class="top-links" aria-label="Primary">
            <a href="projects.html">Projects</a>
            <a href="notes.html">Notes</a>
            <a href="about.html">About</a>
          </nav>
        </header>

        <div class="rule"></div>

        <section class="selected is-landscape">
          <div class="selected-media">
            <a class="zoom" href="media/selected/13.JPG" target="data-full" rel="noopener">
              <img src="media/selected/13.JPG" alt="Solitude" loading="eager">
            </a>
          </div>

          <aside class="selected-meta">
            <h1 class="work-title">04</h1>
            <p class="work-note">
              Burdened by Light
            </p>
            <dl class="work-spec">
              <div>
                <dt>Camera</dt>
                <dd>Leica M10</dd>
              </div>
              <div>
                <dt>Lens</dt>
                <dd>Voigtlander Nokton II 35mm f1.4 s.c</dd>
              </div>
              <div>
                <dt>Shutter</dt>
                <dd>1/30s</dd>
              </div>
            </dl>

            <p class="hint">
              Click the image to open full size.
            </p>
          </aside>
        </section>

        <div class="rule"></div>

        <!-- Prev / Next -->
        <nav class="pager" aria-label="Selected navigation">
          <a class="pager-link" href="solitude03.html">← Previous</a>
          <a class="pager-link" href="solitude05.html">Next →</a>
        </nav>

        <footer class="bottom">
          <div class="bottom-copy">© 2026. HtoG. All rights reserved.</div>
        </footer>

      </div>
    </section>
  </main>
<div class="lb" id="lb" aria-hidden="true">
  <img class="lb-img" id="lbImg" alt="">
</div>
<script>
  (function(){
  const lb = document.getElementById('lb');
  const lbImg = document.getElementById('lbImg');
  if(!lb || !lbImg) return;

  let scale = 1;
  let tx = 0, ty = 0;
  let dragging = false;
  let startX = 0, startY = 0;

  // ✅ 스크롤 잠금(레이아웃 밀림 방지)
  let scrollY = 0;
  function lockScroll(){
    scrollY = window.scrollY || document.documentElement.scrollTop || 0;

    // 데스크탑에서 스크롤바 사라지며 밀리는 현상 방지
    const sbw = window.innerWidth - document.documentElement.clientWidth;
    document.body.style.paddingRight = sbw > 0 ? sbw + 'px' : '';

    document.body.classList.add('lb-open');
    document.body.style.top = `-${scrollY}px`;
  }
  function unlockScroll(){
    document.body.classList.remove('lb-open');
    document.body.style.top = '';
    document.body.style.paddingRight = '';
    window.scrollTo(0, scrollY);
  }

  function apply(){
    lbImg.style.transform =
      `translate(calc(-50% + ${tx}px), calc(-50% + ${ty}px)) scale(${scale})`;
  }

  function openLB(src, alt){
    lb.classList.add('is-open');
    lb.setAttribute('aria-hidden','false');

    scale = 1; tx = 0; ty = 0;
    lbImg.src = src;
    lbImg.alt = alt || '';
    apply();

    lockScroll();
  }

  function closeLB(){
    lb.classList.remove('is-open');
    lb.setAttribute('aria-hidden','true');
    lbImg.removeAttribute('src');

    unlockScroll();
  }

  document.addEventListener('click', (e) => {
    const a = e.target.closest('a.zoom, a.thumb');
    if(!a) return;

    const img = a.querySelector('img');
    const href = a.getAttribute('href') || '';

    if(/\.(jpe?g|png|webp)$/i.test(href)){
      e.preventDefault();
      openLB(href, img ? img.alt : '');
    }
  });

  lb.addEventListener('click', (e) => {
    if(e.target === lb) closeLB();
  });

  window.addEventListener('keydown', (e) => {
    if(e.key === 'Escape' && lb.classList.contains('is-open')) closeLB();
  });

  // 드래그 이동
  lbImg.addEventListener('mousedown', (e) => {
    dragging = true;
    startX = e.clientX - tx;
    startY = e.clientY - ty;
    e.preventDefault();
  });
  window.addEventListener('mousemove', (e) => {
    if(!dragging) return;
    tx = e.clientX - startX;
    ty = e.clientY - startY;
    apply();
  });
  window.addEventListener('mouseup', () => dragging = false);

  // 휠 줌
  lb.addEventListener('wheel', (e) => {
    if(!lb.classList.contains('is-open')) return;
    e.preventDefault();
    const next = scale * (e.deltaY > 0 ? 0.9 : 1.1);
    scale = Math.min(8, Math.max(0.5, next));
    apply();
  }, { passive: false });

  // 모바일 핀치/드래그
  let pinchStartDist = null;

  lb.addEventListener('touchstart', (e) => {
    if(e.touches.length === 2){
      const dx = e.touches[0].clientX - e.touches[1].clientX;
      const dy = e.touches[0].clientY - e.touches[1].clientY;
      pinchStartDist = Math.hypot(dx, dy);
    } else if(e.touches.length === 1){
      dragging = true;
      startX = e.touches[0].clientX - tx;
      startY = e.touches[0].clientY - ty;
    }
  }, { passive: true });

  lb.addEventListener('touchmove', (e) => {
    if(!lb.classList.contains('is-open')) return;

    if(e.touches.length === 2 && pinchStartDist){
      const dx = e.touches[0].clientX - e.touches[1].clientX;
      const dy = e.touches[0].clientY - e.touches[1].clientY;
      const dist = Math.hypot(dx, dy);
      const ratio = dist / pinchStartDist;

      scale = Math.min(8, Math.max(0.5, scale * ratio));
      pinchStartDist = dist;
      apply();
    } else if(e.touches.length === 1 && dragging){
      tx = e.touches[0].clientX - startX;
      ty = e.touches[0].clientY - startY;
      apply();
    }
  }, { passive: true });

  lb.addEventListener('touchend', () => {
    dragging = false;
    pinchStartDist = null;
  });

})();
</script>
  
</body>
</html>